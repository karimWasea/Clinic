@model PagedList.IPagedList<Clinicss.Models.VisitsVm>
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    Layout = "_Layout";
    ViewData["Title"] = "All visits";
}

<!-- Panel for Searching -->
<form asp-action="Index" method="get" class="form-inline">
    <div class="form-group row justify-content-between">
        <input type="text" name="FilterBy" value="@ViewBag.Search" class="form-control w-75 col-10" id="search-input" placeholder="Specialty">
        <button type="submit" class="btn btn-primary col-2">
            Search
            <i class="fas fa-search"></i> <!-- Font Awesome icon for search -->
        </button>
    </div>
</form>
<br />


 
 
<div id="search-results">
    <table class="table table-hover" style="background-color: lightgreen;">
        <thead>
            <tr>
                <th>patientName</th>
                <th>doctorName</th>
                <th>VisitsDate</th>
                <th>Gender</th>
                <th>Adress</th>
                <th>Email</th>
                <th>VisitType</th>
                <th>VisitStuts</th>
                <th>Address</th>
                  <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var visit in Model)
            {
                <tr class="patient">
                    <!-- Add class for JavaScript search functionality -->
                    <td>@visit.patientName</td>
                    <td>@visit.doctorName</td>
                    <td>@visit.VisitsApientment.ToShortTimeString()</td>
                     <td>@visit.Gender</td>
                    <td>@visit.Address</td>
                    <td>@visit.Email</td>

                    <td>@visit.Visisttype</td>
                    <td>@visit.VisitStutus</td>
                    <td>@visit.Address</td>
                    <td>
                         
                        <a asp-action="CreatApiontment" asp-route-Doctorid="@visit.doctorid" asp-route-id="@visit.Id" class="btn btn-primary">
                            <i class="fas fa-edit"></i>  Edit
                        </a>

                        
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

<partial name="_PaginationPartial" model="Model" />

@section Scripts {
    <script src="https://kit.fontawesome.com/a076d05399.js"></script> <!-- Include Font Awesome library -->
    <script>
        // Get the search input element
        const searchInput = document.getElementById('search-input');

        // Get the patient rows
        const patientRows = document.querySelectorAll('.patient');

        // Function to update the search results
        function updateSearchResults() {
            const searchText = searchInput.value.toLowerCase();

            patientRows.forEach(patientRow => {
                const patientText = patientRow.textContent.toLowerCase();
                if (patientText.includes(searchText)) {
                    patientRow.style.display = 'table-row';
                } else {
                    patientRow.style.display = 'none';
                }
            });
        }

        // Add an event listener to the search input to listen for input changes
        searchInput.addEventListener('input', function () {
            updateSearchResults();
        });

        // Initial call to populate search results
        updateSearchResults();
    </script>
}
